<!-- Header -->
<p align="center">
  <img src="https://capsule-render.vercel.app/api?type=soft&height=180&text=🗂️%20Document%20Type%20Classification&fontSize=35&descSize=20&descAlignY=65&color=gradient&customColorList=0,2,6,11,20&fontColor=ffffff&animation=fadeIn" alt="Document Type Classification | 문서 타입 분류"/>
</p>

<h2 align="center"> 4조 VIBE (Visual Intelligence and Language Engineering) </h3>
<h3 align="center"> 🔍 다양한 종류의 문서 이미지의 클래스를 예측 </h3>

<div align="center">
  <a href="https://github.com/yourusername/yourrepo">
    <img src="https://img.shields.io/github/stars/yourusername/yourrepo?style=social" alt="GitHub stars"/>
  </a>
  <a href="https://github.com/yourusername/yourrepo">
    <img src="https://img.shields.io/github/forks/yourusername/yourrepo?style=social" alt="GitHub forks"/>
  </a>
</div>

<br>



## 👨‍👩‍👦‍👦 팀 구성원

<div align="center">

<table>
<tr>
<td align="center" width="200px">
<a href="https://github.com/imeanseo"><img src="https://avatars.githubusercontent.com/u/221927853?v=4" width="200px;" alt="고민서"/></a>
</td>
<td align="center" width="200px">
<a href="https://github.com/oriori88"><img src="https://avatars.githubusercontent.com/u/11532528?v=4" width="200px;" alt="김소은"/></a>
</td>
<td align="center" width="200px">
<a href="https://github.com/Leesoomin97"><img src="https://avatars.githubusercontent.com/u/218931464?v=4" width="200px;" alt="이수민"/></a>
</td>
<td align="center" width="200px">
<a href="https://github.com/dg5407"><img src="https://avatars.githubusercontent.com/u/221937194?v=4" width="200px;" alt="이동건"/></a>
</td>
<td align="center" width="200px">
<a href="https://github.com/vforjj"><img src="https://avatars.githubusercontent.com/u/227140598?v=4" width="200px;" alt="주예령"/></a>
</td>
</tr>
<tr>
<td align="center"><a href="https://github.com/imeanseo"><b>👑 고민서 (팀장)</b></a></td>
<td align="center"><a href="https://github.com/oriori88"><b>😺 김소은</b></a></td>
<td align="center"><a href="https://github.com/Leesoomin97"><b>🐿️ 이수민</b></a></td>
<td align="center"><a href="https://github.com/dg5407"><b>👨🏻‍💻 이동건</b></a></td>
<td align="center"><a href="https://github.com/vforjj"><b>🐥 주예령</b></a></td>
</tr>
<tr>
<td align="center">
    <sub><b>📌 담당 역할</b></sub><br>
    <sub>✅ EDA </sub><br>
    <sub>✅ Preprocessing</sub><br>
    <sub>✅ Modeling </sub><br>
    <sub>✅ Organize PPT </sub><br>
    <sub>✅ Organize ReadMe/Git </sub>
</td>
<td align="center">
    <sub><b>📌 담당 역할</b></sub><br>
    <sub>✅ EDA </sub><br>
    <sub>✅ Preprocessing</sub><br>
    <sub>✅ Modeling </sub><br>
    <sub>✅ Organize PPT </sub><br>
</td>
<td align="center">
    <sub><b>📌 담당 역할</b></sub><br>
    <sub>✅ EDA </sub><br>
    <sub>✅ Preprocessing</sub><br>
    <sub>✅ Modeling </sub><br>
    <sub>✅ Organize PPT </sub><br>
</td>
<td align="center">
    <sub><b>📌 담당 역할</b></sub><br>
    <sub>✅ EDA </sub><br>
    <sub>✅ Preprocessing</sub><br>
    <sub>✅ Modeling </sub><br>
    <sub>✅ Organize PPT </sub><br>
</td>
<td align="center">
    <sub><b>📌 담당 역할</b></sub><br>
    <sub>✅ Organize PPT </sub><br>
</td>
</tr>
</table>

</div>


</div>

## 0. Overview

### Environment

<p align="left">
  <img src="https://img.shields.io/badge/python-blue?logo=python&logoColor=white" alt="Python"/>
  <img src="https://img.shields.io/badge/pytorch-EE4C2C?logo=pytorch&logoColor=white" alt="PyTorch"/>
  <img src="https://img.shields.io/badge/CUDA-FB7047?logo=nvidia&logoColor=white" alt="CUDA"/>
  <img src="https://img.shields.io/badge/cuDNN-red" alt="cuDNN"/>
  <img src="https://img.shields.io/badge/Jupyter-Notebook-F37626?logo=jupyter&logoColor=white" alt="Jupyter Notebook"/>
  <img src="https://img.shields.io/badge/VSCode-007ACC?logo=visualstudiocode&logoColor=white" alt="VSCode"/>
  <img src="https://img.shields.io/badge/W&B-20232A?logo=wandb&logoColor=white" alt="Weights & Biases"/>
  <img src="https://img.shields.io/badge/Git-F05032?logo=git&logoColor=white" alt="Git"/>
  <img src="https://img.shields.io/badge/GitHub-181717?logo=github&logoColor=white" alt="GitHub"/>
</p>

### Communication Tools

<p align="left">
  <img src="https://img.shields.io/badge/Slack-4A154B?style=for-the-badge&logo=slack&logoColor=white" alt="Slack"/>
  <img src="https://img.shields.io/badge/Zoom-2D8CFF?style=for-the-badge&logo=zoom&logoColor=white" alt="Zoom"/>
  <img src="https://img.shields.io/badge/Google%20Drive-4285F4?style=for-the-badge&logo=googledrive&logoColor=white" alt="Google Drive"/>
</p>

### Requirements
Package | Version
--- | ---
albumentations | 1.3.1
conda | 23.9.0
GitPython | 3.1.45
huggingface-hub | 0.19.4
ipykernel | 6.27.1
ipython | 8.15.0
jupyter | 1.0.0
matplotlib | 3.10.7
notebook | 7.0.6
numpy | 1.26.4
pandas | 2.1.4
scikit-learn | 1.7.2
scipy | 1.15.3
seaborn | 0.13.2
tensorflow | 2.20.0
timm | 0.9.12
torch | 2.1.0
torchvision | 0.16.0
wandb | 0.22.3


## 1. Competiton Info

### Overview

이번 대회는 computer vision domain에서 가장 중요한 태스크인 이미지 분류 대회입니다.

이미지 분류란 주어진 이미지를 여러 클래스 중 하나로 분류하는 작업입니다. 이러한 이미지 분류는 의료, 패션, 보안 등 여러 현업에서 기초적으로 활용되는 태스크입니다. 딥러닝과 컴퓨터 비전 기술의 발전으로 인한 뛰어난 성능을 통해 현업에서 많은 가치를 창출하고 있습니다.

<p align="center">
  <img width="662" alt="image" src="https://github.com/user-attachments/assets/eea28122-bc19-444b-b86a-f23ea7490873" />
</p>

그 중, 이번 대회는 문서 타입 분류를 위한 이미지 분류 대회입니다. 문서 데이터는 금융, 의료, 보험, 물류 등 산업 전반에 가장 많은 데이터이며, 많은 대기업에서 디지털 혁신을 위해 문서 유형을 분류하고자 합니다. 이러한 문서 타입 분류는 의료, 금융 등 여러 비즈니스 분야에서 대량의 문서 이미지를 식별하고 자동화 처리를 가능케 할 수 있습니다.

이번 대회에 사용될 데이터는 총 17개 종의 문서로 분류되어 있습니다. 1570장의 학습 이미지를 통해 3140장의 평가 이미지를 예측하게 됩니다. 특히, 현업에서 사용하는 실 데이터를 기반으로 대회를 제작하여 대회와 현업의 갭을 최대한 줄였습니다. 또한 현업에서 생길 수 있는 여러 문서 상태에 대한 이미지를 구축하였습니다.



이번 대회를 통해서 문서 타입 데이터셋을 이용해 이미지 분류를 모델을 구축합니다. 주어진 문서 이미지를 입력 받아 17개의 클래스 중 정답을 예측하게 됩니다. computer vision에서 중요한 backbone 모델들을 실제 활용해보고, 좋은 성능을 가지는 모델을 개발할 수 있습니다. 그 밖에 학습했던 여러 테크닉들을 적용해 볼 수 있습니다.

본 대회는 결과물 csv 확장자 파일을 제출하게 됩니다.

input : 3140개의 이미지

output : 주어진 이미지의 클래스

---
### Timeline

<img width="1153" height="502" alt="image" src="https://github.com/user-attachments/assets/825368ee-d659-4520-9572-90d445ffb158" />


## 2. Components

### Directory

- _Insert your directory structure_


## 3. Data descrption

### Dataset overview

🧠 학습 데이터셋 (Training Dataset)
📁 train/ 폴더

총 1,570장의 이미지가 저장되어 있습니다.

📄 train.csv

총 1,570개 행(row) 으로 구성되어 있으며, train/ 폴더의 이미지와 정답 클래스 정보를 제공합니다.

컬럼명	설명
ID	학습 샘플의 파일명
target	학습 샘플의 정답 클래스 번호
<p align="center"> <img width="276" height="413" alt="train.csv 예시" src="https://github.com/user-attachments/assets/47ca222e-a938-488e-9b3a-f0286cbfc195" /> </p>
📄 meta.csv

총 17개 행(row) 으로 구성되어 있으며, 클래스 번호(target)와 클래스 이름(class_name)의 매핑 정보를 제공합니다.

컬럼명	설명
target	클래스 번호 (0 ~ 16)
class_name	클래스 이름
<p align="center"> <img width="331" height="414" alt="meta.csv 예시" src="https://github.com/user-attachments/assets/25d14a21-f97f-4ba1-ac16-095a2f786d10" /> </p>
🧩 평가 데이터셋 (Evaluation Dataset)
📁 test/ 폴더

총 3,140장의 이미지가 저장되어 있습니다.

일부 이미지는 랜덤한 회전(Rotation), 뒤집기(Flip), 훼손(Distortion) 등의 변형이 적용되어 있습니다.

📄 sample_submission.csv

총 3,140개 행(row) 으로 구성되어 있으며, 제출 시 예측 결과(target)를 채워야 합니다.

컬럼명	설명
ID	평가 샘플의 파일명
target	예측 결과가 입력될 컬럼 (초기값: 0)
<p align="center"> <img width="284" height="413" alt="sample_submission.csv 예시" src="https://github.com/user-attachments/assets/e2d75ae3-276c-46ba-8f2a-200114875932" /> </p>

---

### 🔍 EDA (Exploratory Data Analysis)

#### EDA Process

학습 데이터(train.csv)와 meta.csv를 분석하여 17개의 클래스 분포와 파일 수를 확인함

클래스 간 데이터 불균형이 존재함을 확인 → 이후 학습 시 클래스 가중치 보정 전략을 적용하기로 결정

이미지 품질을 육안으로 점검한 결과, 일부 이미지에서 밝기·노이즈·색상 왜곡이 관찰됨

텍스트 기반 분석(OCR)도 시도했으나, 손상된 이미지로 인해 글자 인식률이 낮아 활용 불가 판정

<img width="2382" height="730" alt="image" src="https://github.com/user-attachments/assets/d9964036-2806-4da0-a027-a2c172f8bf91" />


#### EDA Conclusion

데이터의 품질과 조도 차이가 모델 성능에 큰 영향을 미칠 것으로 판단

이에 따라, 이후 단계에서 노이즈 제거와 색상 보정 중심의 전처리 강화 방향으로 결정

데이터 불균형과 이미지 훼손 문제를 해결하기 위한 전처리 및 학습 전략 수립 완료


---

### ⚙️ Data Processing

#### Preprocessing Strategy

팀원별로 서로 다른 전처리 실험을 수행하며 밝기·노이즈·색상 변화의 영향을 비교 평가

실험 결과를 회의에서 공유하고, 효과가 우수했던 전처리 조합 중심으로 통합 결정

#### Key Techniques Used

문서 재질 및 노이즈 중심 전처리 강화

Gaussian Blur, CLAHE (Contrast Limited Adaptive Histogram Equalization), White Balance 등의 실험적 조합 적용

<img width="1951" height="595" alt="image" src="https://github.com/user-attachments/assets/5c34c1ae-aa06-411c-b267-39b39a54fa46" />

데이터 다양성 확보

매 epoch마다 랜덤 데이터 증강(Augmentation) 을 적용하여 일반화 성능 향상

Stage별 전처리 파이프라인 자동화

각 단계별 전처리 기능을 스크립트화하여 자동 실행 구조로 관리

---

### 🧠 Modeling

#### Model Description

여러 구조적 특성을 비교하기 위해 다양한 모델을 실험적으로 적용:

- EfficientNet-B3 / B4 / B5

- ConvNeXt

- ViT (Vision Transformer)

각 모델의 파라미터 효율성과 시각적 패턴 인식 성능을 검증 후, Ensemble 기반 접근으로 확장

#### Why We Selected These Models

EfficientNet 계열은 파라미터 대비 성능이 우수하고, 작은 데이터셋에서도 안정적

ConvNeXt는 현대적인 CNN 구조로 복잡한 질감·패턴 인식에 강함

ViT는 글자·질감 등 장거리 시각 정보 학습에 효과적이어서 조합 시 상호보완적 구조 가능



---

### 🚀 Modeling Process

#### Training & Testing

Stage별 학습 구조화:

1단계: 전체 데이터를 학습하여 기본 모델 확보

2단계: 유사도가 높은 병원 관련 클래스(3, 7, 14)를 별도 서브모델로 분리 학습 → 세밀한 분류 개선

wandb를 활용하여:

실험 로그 및 하이퍼파라미터 관리

모델별 성능 비교 및 시각화

Test Time Augmentation (TTA) 을 시도했으나, 일부 케이스에서 오히려 성능 하락 → 최적 조합만 선별 적용

---

## 🏆 Final Result & Ensemble

최종적으로 상위 성능 모델들의 결과를 하드보팅(Hard Voting) 으로 앙상블

제출했던 여러 리더보드 CSV 중 상위 7개 결과를 하드보팅한 조합에서 최고 성능 달성

### 최종 Public Leaderboard 점수: 0.9499 (2위)

## 5. Result

### Leader Board
<img width="1228" height="626" alt="image" src="https://github.com/user-attachments/assets/38a9988d-90f0-4d25-8465-91b7c396d719" />

<img width="1241" height="639" alt="image" src="https://github.com/user-attachments/assets/43fa0ed7-9828-42d7-9651-20d760cf7dd9" />
<p align="center">
  중간 순위 0.9852에서 1위에서 최종 순위는 0.9475로 2등으로 결정됨
</p>


### Presentation
[![Presentation](https://github.com/user-attachments/assets/42fb1776-4f02-4cac-bbd2-77225e253af6)](https://docs.google.com/presentation/d/1Pc4JzGhqG0PY4wVeC9hVAeT_XcljLxX6/edit?slide=id.g37012e7854d_7_60#slide=id.g37012e7854d_7_60)

<p align="center">
  이미지를 누르면 상세한 PPT를 볼 수 있습니다.
</p>

## etc

### Meeting Log
<table>
  <tr>
    <td align="center" style="border-right: 1px solid #ccc; padding-right: 15px;">
      <img src="https://github.com/user-attachments/assets/0cfa625a-8128-462b-8a8c-6eeaf726eba0" width="400px" alt="미팅 로그 1"/>
      <hr style="margin: 10px 0; border: 1px solid #eee;">
      <div style="font-size: 14px; color: #555;">
        Zoom 조원 채팅방을 통한 정기적 회의 진행 (오전 10:30, 오후 6:30, 문제 발생 시 실시간 호출)
      </div>
    </td>
    <td align="center" style="padding-left: 15px;">
      <img src="https://github.com/user-attachments/assets/b5d7b7f7-1381-42f6-af02-e85c1051fb1c" width="400px" alt="미팅 로그 2"/>
      <hr style="margin: 10px 0; border: 1px solid #eee;">
      <div style="font-size: 14px; color: #555; margin-top: 10px;">
        Slack을 이용한 실시간 소통
      </div>
    </td>
    <td align="center" style="padding-left: 15px;">
      <img src="https://github.com/user-attachments/assets/17aa9d24-d1a5-49cb-a353-c3bf3c6cc310" width="400px" alt="미팅 로그 3"/>
      <hr style="margin: 10px 0; border: 1px solid #eee;">
      <div style="font-size: 14px; color: #555; margin-top: 10px;">
        Slack을 이용한 코드 공유
      </div>
    </td>
  </tr>
</table>

### Reference

- 🔗 [Weights & Biases Sweep](https://wandb.ai/site)
- 🤖 [HuggingFace SwinIR models](https://huggingface.co/models?other=swin-ir)
- 📄 [Learning Loss for Test-Time Augmentation (arXiv:2010.11422)](https://arxiv.org/abs/2010.11422)
- 📚 [EfficientNet Documentation - tfimm](https://tfimm.readthedocs.io/en/latest/content/efficientnet.html#tfimm.architectures.efficientnet.EfficientNet)
- 📖 [데이터 증강을 통한 딥 러닝 네트워크 정확도 향상 방법 - 조수영 박사 논문 (한국교육학술정보원)](https://scienceon.kisti.re.kr/srch/selectPORSrchArticle.do?cn=DIKO0015551607)
